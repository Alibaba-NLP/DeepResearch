Refactor react_agent.py to improve security and maintainability